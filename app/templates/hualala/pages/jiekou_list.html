{% extends "/hualala/pages/base.html" %}
{% block content %}
    <style type="text/css">
        .mt-10 {
            margin-top: 25px;
        }
        .mt-low {
            margin-top: 15px;
        }
.textarea{
    width: 650px;
    min-height: 220px;
    max-height: 300px;
    _height: 120px;
    margin-left: auto;
    margin-right: auto;
    padding: 3px;
    outline: 0;
    border: 1px solid #a0b3d6;
    font-size: 12px;
    line-height: 24px;
    padding: 2px;
    word-wrap: break-word;
    overflow-x: hidden;
    overflow-y: auto;
    border-color: rgba(82, 168, 236, 0.8);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6);
}
        .row.no-gutter {
            margin-left: 0;
            margin-right: 0;
        }
    </style>

    <div class="modal fade" id="publick_db" tabindex="-1" role="dialog" aria-labelledby="publick_db" aria-hidden="true">
    <div class="modal-dialog"  style="width:700px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">接口配置操作</h4>
            </div>
            <div class="modal-body">
                <ul id="myTab" class="nav nav-tabs">
                    <li class="active">
                        <a href="#home" data-toggle="tab">
                            创建接口
                        </a>
                    </li>
                    <li><a href="#ios" data-toggle="tab">公共config</a></li>
                     <li><a href="#private_config" data-toggle="tab">接口config</a></li>
                <li><a href="#jmeter" data-toggle="tab">数据库配置</a></li>

                </ul>

                <div id="myTabContent" class="tab-content">
                    <div class="tab-pane fade in active" id="home">
                        <div class="container-fluid">
                            <div class="row mt-low">
                                <form class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-lg-2 control-label">选择环境</label>
                                        <div class="col-lg-10" name="file_secret">
                                            <select class="form-control"  id="create_change_huanjing">
                                                <option>{{ select_huanjing }}</option>
                                                {% for i in huanjing %}
                                                    <option>{{ i }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="row mt-low">
                                <form class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-lg-2 control-label">选择业务</label>
                                        <div class="col-lg-10" name="file_yewu">
                                            <select class="form-control"  id="create_file_yewu">
                                                {% for i in yewu_name %}
                                                    <option>{{ i }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="row mt-low">
                                <form class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-lg-2 control-label">接口类型</label>
                                        <div class="col-lg-10" name="sign_type">
                                            <select class="form-control">
                                                <option>xiang_qian</option>
                                                <option>web</option>
                                                <option>app</option>
                                                <option>Backstage_web</option>
                                                <option>jy_appServer</option>
                                                <option>zhixin</option>
                                                <option>haofang_server</option>
                                                <option>hkci</option>
                                                <option>hengfeng_w</option>
                                            </select>
                                        </div>
                                    </div>
                                </form>
                            </div>

                     <div name="login_info">
                             <div class="row mt-low">
                                <form class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-lg-2 control-label">登录信息</label>
                                        <div class="col-lg-10">
                                            <div class="input-group">
                                                <span class="input-group-addon">登录地址</span>
                                                <input type="text" class="form-control" id="login-url"
                                                       aria-describedby="basic-addon3">
                                            </div>

                                        </div>
                                    </div>
                                </form>
                             </div>

                            <div class="row mt-low">
                                <form class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-lg-2 control-label"></label>
                                        <div class="col-lg-5">
                                            <div class="input-group">
                                                <span class="input-group-addon">用户名</span>
                                                <input type="text" class="form-control" id="login-name"
                                                       aria-describedby="basic-addon3">
                                            </div>
                                              </div>
                                         <div class="col-lg-5">
                                            <div class="input-group">
                                                <span class="input-group-addon">密码</span>
                                                <input type="text" class="form-control" id="login-password"
                                                       aria-describedby="basic-addon3">
                                            </div>

                                        </div>
                                    </div>
                                </form>
                             </div>
                         </div>


                            <div class="row mt-low">
                                <form class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-lg-2 control-label">请求方式</label>
                                        <div class="col-lg-10" name="file_method">
                                            <select class="form-control">
                                                <option>get</option>
                                                <option>post</option>
                                            </select>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div name="chuancan_type">
                            <div class="row mt-low">
                                <form class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-lg-2 control-label">传参方式</label>
                                        <div class="col-lg-10" name="send_request">
                                            <select class="form-control">
                                                <option>json</option>
                                                <option>form_data</option>
                                            </select>
                                        </div>
                                    </div>
                                </form>
                            </div>
                                 </div>

                            <div class="row mt-low"  name="file_top_url">
                                <div class="col-lg-12">
                                    <div class="input-group">
                                        <span class="input-group-addon" id="basic-addon3">private_url</span>
                                        <input type="text" class="form-control" id="basic-url"
                                               aria-describedby="basic-addon3">
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-low"  name="jiekou_name">
                                <div class="col-lg-12">
                                    <div class="input-group">
                                        <span class="input-group-addon" id="basic-addon3">接口名</span>
                                        <input type="text" class="form-control" id="file_jiekou_name"
                                               aria-describedby="basic-addon3">
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-low">
                                <div class="col-lg-12">
                                    <label><h4>json 模板</h4></label>
                                    <div class="textarea"   spellcheck="false"  contenteditable="true" id="json_template"><br/></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="ios">
                                            <div class="container-fluid">
                        <div class="row mt-low">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-lg-2 control-label">选择环境</label>
                                    <div class="col-lg-10" name="file_secret_publick">
                                        <select class="form-control"  name="publick_config_change"   id="publick_config_select_huanjing">
                                            <option>{{ select_huanjing }}</option>
                                            {% for i in huanjing %}
                                                <option>{{ i }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>

                                                       <div class="row mt-low">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-lg-2 control-label">选择业务</label>
                                    <div class="col-lg-10" name="file_yewu_publick">
                                        <select class="form-control"  name="publick_config_change"  id="publick_config_change_yewu_select">
                                            {% for i in yewu_name %}
                                            <option>{{ i }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>
                                                                        <div class="row mt-low">
                                <div class="col-lg-12">
                                    <label><h4>配置信息</h4></label>
                                    <div class="textarea"   spellcheck="false"  contenteditable="true" id="json_template_publick"><br/></div>
                                </div>
                            </div>

                                            </div>
                    </div>
                                    <div class="tab-pane fade" id="private_config">
                                            <div class="container-fluid">
                        <div class="row mt-low">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-lg-2 control-label">选择环境</label>
                                    <div class="col-lg-10" name="private_config_file">
                                        <select class="form-control"  name="file_yewu_private_select"  id="jiekou_huanjing_change">
                                            <option>{{ select_huanjing }}</option>
                                            {% for i in huanjing %}
                                                <option>{{ i }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>

                                                       <div class="row mt-low">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-lg-2 control-label">选择业务</label>
                                    <div class="col-lg-10" name="file_yewu_private">
                                        <select class="form-control"  name="file_yewu_private_select" id="yewu_private_selec_change">
                                            {% for i in yewu_name %}
                                            <option>{{ i }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>


                                                <div class="row mt-low">
                                                    <form class="form-horizontal">
                                                        <div class="form-group">
                                                            <label class="col-lg-2 control-label">选择接口</label>
                                                            <div class="col-lg-10" name="file_yewu_private">
                                                                <select class="form-control"  name="file_yewu_private_select"  id="private_select_jjiekou_select">
                                                                    {% for i in yewu_name %}
                                                                        {% for z in yewu_name[i] %}

                                                                            <option name={{ i }}  class={{ i+'#'+z }}><a href="#"
                                                                                                                         name="jiekoulist">{{ z }}</a>
                                                                            </option>
                                                                        {% endfor %}
                                                                    {% endfor %}
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>

                                                <div class="row mt-low">
                                                    <div class="col-lg-12">
                                                        <label><h4>config配置信息</h4></label>
                                                        <div class="textarea"   spellcheck="false"  contenteditable="true" id="json_template_private"><br/></div>
                                                    </div>
                                                </div>

                                                <div class="row mt-low">
                                                    <div class="col-lg-12">
                                                        <label><h4>json模板</h4></label>
                                                        <div class="textarea"   spellcheck="false"  contenteditable="true" id="json_moban_private"><br/></div>
                                                    </div>
                                                </div>

                                            </div>
                                    </div>
                    <div class="tab-pane fade" id="jmeter">
                         <div class="container-fluid">
                        <div class="row mt-low">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-lg-2 control-label">选择环境</label>
                                    <div class="col-lg-10" name="file_secret_db">
                                        <select class="form-control"  name="db_config_change">
                                            <option>{{ select_huanjing }}</option>
                                            {% for i in huanjing %}
                                                <option>{{ i }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>

                                                       <div class="row mt-low">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-lg-2 control-label">选择业务</label>
                                    <div class="col-lg-10" name="file_yewu_db">
                                        <select class="form-control"   name="db_config_change">
                                            {% for i in yewu_name %}
                                            <option>{{ i }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>
                                                                        <div class="row mt-low">
                                <div class="col-lg-12">
                                    <label><h4>配置信息</h4></label>
                                    <div class="textarea"   spellcheck="false" contenteditable="true" id="json_template_db"><br/></div>
                                </div>
                            </div>

                                            </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">close</button>
                <button type="button" class="btn btn-primary" id="create_file_save_last" style="z-index:1000;">Save changes</button>

            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
    <div class="container-fluid">
        <div class="row mt-10">
            <div class="col-lg-3">
                <form class="form-inline" role="form" action="/uplate_jiekou_list" method="post">
                    <div class="input-group">
                        <span class="input-group-addon  span-info"  name="get_port" port={{ local_port }}>输入目录</span>
                        <input type="text" name="mulu" class="form-control" placeholder="Search for..." id="mulu_url"
                               value={{ gen_mulu }}>
                        <span class="input-group-btn">
                     <button class="btn btn-success" id="submit_url" type="submit">Go!</button>
                </span>
                    </div>
                </form>
            </div>
            <div class="col-lg-3">
                <div class="btn-group" role="group" aria-label="...">
                    <button type="button" class="btn btn-default" id="pilaing_yunxing">批量运行</button>
                                    <button class="btn btn-default" data-toggle="modal" data-target="#publick_db">生成接口文件</button>
                    <button type="button" class="btn btn-default" title="运行信息" data-trigger="focus"
                            id="run_result_open">
                        查看运行结果
                    </button>

                </div>
            </div>

            <div class="col-lg-3">

                    <div class="input-group">
                        <span class="input-group-addon  span-info" id="guanlian_ip" >关联ip</span>
                        <input type="text"  class="form-control" placeholder="ip 地址" id="ip_guanlian">
                        <span class="input-group-btn">
                     <button class="btn btn-success" id="submit_guanlian_ip" type="submit">Go!</button>
                </span>
                    </div>

            </div>

            <div class="col-lg-3">
                <form class="form-inline" role="form" action="/uplate_jiekou_list" method="post">
                    <div class="input-group">
                        <span class="input-group-addon  span-info" id="tag_shuruip" name={{ ip_server }}>输入ip</span>
                        <input type="text" name="ip_dizhi" class="form-control" placeholder="ip 地址" id="ip_地址"
                               value={{ ip_server }}>
                        <span class="input-group-btn">
                     <button class="btn btn-success" id="submit_url" type="submit">Go!</button>
                </span>
                    </div>
                </form>
            </div>
        </div>
        <div class="row mt-10">
            <div class="col-lg-12">
                <div class="panel panel-success">
                    <div class="panel-heading">文件列表</div>
                    <div class="panel-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-lg-10">
                                    <div class="btn-toolbar" role="toolbar" aria-label="...">
                                        <div class="btn-group" role="group" aria-label="...">
                                            <div class="btn-group" id="format">
                                                {% for i in yewu_name %}
                                                    <button type="button" class="btn btn-default"
                                                            name={{ i }} id={{ i }}+"checkbox">{{ i }} </button>
                                                {% endfor %}
                                            </div>
                                        </div>
                                        <div class="btn-group" id="huanjing">
                                            <div id="huanjing1">
                                                <button style="min-width: 160px;" type="button"
                                                        class="btn btn-default dropdown-toggle btn-block"
                                                        data-toggle="dropdown" aria-haspopup="true"
                                                        aria-expanded="false">
                                                    <a id="check_0" name={{ all_mulu }}>{{ select_huanjing }}</a><span
                                                        class="caret"></span>
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><a href="#" name="huanjing_list">{{ select_huanjing }}</a></li>
                                                    {% for i in huanjing %}
                                                        <li><a href="#" name="huanjing_list">{{ i }}</a></li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="btn-group" id="select">
                                            <div id="selectmenu">
                                                <button style="min-width: 160px;" type="button"
                                                        class="btn btn-default dropdown-toggle btn-block"
                                                        data-toggle="dropdown" aria-haspopup="true"
                                                        aria-expanded="false">
                                                    <a id="check_1">all</a><span class="caret"></span>
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><a href="#" name="huanjing_list">all</a></li>
                                                    {% for i in yewu_name %}
                                                        <li><a href="#" name="huanjing_list">{{ i }}</a></li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="btn-group" id="selecttwo">
                                            <button style="min-width: 160px;" type="button"
                                                    class="btn btn-default dropdown-toggle btn-block"
                                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                <a id="check_2">all</a><span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li name="all_two" class="all_two"><a href="#" name="jiekoulist">all</a>
                                                </li>
                                                <li name="all" class="all"><a href="#"
                                                                              name="jiekoulist">all</a>
                                                </li>
                                                {% for i in yewu_name %}
                                                    {% for z in yewu_name[i] %}
                                                        <li name={{ i }}  class={{ i+'#'+z }}><a href="#"
                                                                                                 name="jiekoulist">{{ z }}</a>
                                                        </li>
                                                    {% endfor %}
                                                {% endfor %}
                                            </ul>
                                        </div>
                                        <button type="button" class="btn btn-default" data-toggle="modal"
                                                data-target="#git_submit">
                                            上传git
                                        </button>
                                        <button data-toggle="modal" data-target="#take_linux_log_kuang" type="button"
                                                class="btn btn-default" data-toggle="modal"
                                                data-target="#take_server_log">
                                            服务器log截取
                                        </button>
                                    </div>
                                </div>


                                <div class="input-group col-lg-2 ">
                                    <input type="text" class="form-control" placeholder="Search for..."
                                           id="sousuo_name">
                                    <span class="input-group-btn">
        <button class="btn btn-default" type="button" id="case_sousuo">搜索</button>
      </span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <div id="table">
                                        <table id="table4" class="table table-hover table-striped">
                                            <thead>
                                            <th align="left" width="20%"><input type="checkbox" name="allcheck"
                                                                                id="allcheck">
                                                <label>全选</label></th>
                                            <th align="left" width="25%">业务名</th>
                                            <th align="left" width="25%">接口名</th>
                                            <th align="center" width="15%">运行</th>
                                            <th align="center" width="15%">调试</th>
                                            <th align="center" width="15%">open_file</th>
                                            </thead>
                                            {% for i in yewu_name %}
                                                {% for x in yewu_name[i] %}
                                                    <tr name={{ i }} class={{ x }} id="select_two">
                                                        <td align="left"><input type="checkbox" name="childcheck"
                                                                                class={{ i+"#"+x }}></td>
                                                        <td align="left">{{ i }}</td>
                                                        <td align="left">{{ x }}</td>
                                                        <td align="center" name={{ x }}>
                                                            <button type="button" class="btn btn-default"
                                                                    aria-label="Left Align" name="simple_run_list">
                                                                <span class="glyphicon glyphicon-triangle-right"
                                                                      aria-hidden="true"
                                                                      class={{ i+"#"+x }} name="simple_run"></span>
                                                            </button>
                                                        </td>
                                                        <td align="center" name={{ x }}>
                                                            {% if yizhi==1 %}
                                                                <button type="button" class="btn btn-default"
                                                                        aria-label="Left Align"
                                                                        name="tiaoshi_tiaozhuan">
                                                                    <span class="glyphicon glyphicon-erase"
                                                                          aria-hidden="true" name={{ i+"#"+x }}></span>
                                                                </button></td>
                                                            {% else %}
                                                                <button type="button" class="btn btn-default"
                                                                        aria-label="Left Align" disabled="true">
                                                                    <span class="glyphicon glyphicon-erase"
                                                                          aria-hidden="true"></span></button></td>
                                                            {% endif %}
                                                        </td>
                                                        <td align="center" name={{ x }}>
                                                            <button type="button" class="btn btn-default" name="open_file" aria-label="Left Align">
                                                                <span class="glyphicon glyphicon-log-in " aria-hidden="true"></span>
                                                            </button>

                                                        </td>
                                                    </tr>
                                                {% endfor %}
                                            {% endfor %}
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 模态框（Modal） -->
    <div class="modal fade" id="file_up" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form action="/upload_file" method="post" enctype="multipart/form-data">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
                        </button>
                        <h4 class="modal-title" id="myModalLabel">
                            模态框（Modal）标题
                        </h4>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid  ">
                            <div class="row mt-10">
                                <div class="col-lg-12">
                                    <div class="form-group" id="file_container">
                                        <input type="file" name="files" multiple>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-10">
                                <div class="col-lg-12">
                                    <div class="input-group">
                                        <span class="input-group-addon" id="basic-addon1">脚本备注</span>
                                        <input type="text" class="form-control" placeholder="Username" id="file_detail"
                                               aria-describedby="basic-addon1">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button " class="btn btn-default" data-dismiss="modal">
                            关闭
                        </button>
                        <button type="button submit " class="btn btn-primary" id="submit">
                            提交
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>




<!-- Modal -->
<div class="modal fade" id="git_submit" tabindex="-1" role="dialog" aria-labelledby="git_submit">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" >上传git</h4>
      </div>
      <div class="modal-body">
        <div class="input-group">
  <span class="input-group-addon" id="mulu">文件目录</span>
  <input type="text" class="form-control" placeholder="文件目录" aria-describedby="basic-addon1">
                 </div>
           <pre  style = "border:none; background:none"></pre>
                  <div class="input-group">
            <span class="input-group-addon" id="git_address">git库地址</span>
  <input type="text" class="form-control" placeholder="git地址" aria-describedby="basic-addon1">
</div>
          <pre  style = "border:none; background:none"></pre>
          <div class="alert alert-warning" role="alert"  id="git_submit_alert"  style="display:none;">参数不能为空</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary"  id="git_submit_button">上传</button>
      </div>
    </div>
  </div>
</div>






<div class="modal fade" id="take_linux_log_kuang" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog"  style="width:800px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" >日志截取设置</h4>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                     <div class="row mt-low">
                          <div class="col-lg-12">
                                                    <form class="form-horizontal">

                                        <label class="control-label"  name="log_label">选择环境</label>
                                        <div  name="file_secret">
                                            <select class="form-control"  id="log_change_huanjing">
                                                <option>{{ select_huanjing }}</option>
                                                {% for i in huanjing %}
                                                    <option>{{ i }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                </form>
                          </div>
                             </div>
                                                <div class="row mt-low">
                                                     <div class="col-lg-12">
                                    <div class="form-group">
                                        <label class="control-label" name="log_label">选择业务</label>
                                        <div  name="file_yewu">
                                            <select class="form-control"  id="log_file_yewu">
                                                {% for i in yewu_name %}
                                                    <option>{{ i }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                            </div>
                                                     <pre style="border:none; background:none"></pre>
</div>
                    <div class="panel panel-info">
                         <div class="panel-heading">log截取设置信息</div>
  <div class="panel-body">
                <div id="log_all">
                    <div class="row mt-low">
                        <div class="col-lg-12">
                            <div class="input-group">
                                <span class="input-group-addon">日志目录</span>
                                <input type="text" class="form-control"
                                       aria-describedby="basic-addon1" id="log_mulu">
                            </div>
                        </div>
                    </div>
                    <div class="row mt-low">
                        <div class="col-lg-12">
                            <div class="input-group">
                                <span class="input-group-addon">服务器地址</span>
                                <input type="text" class="form-control"
                                       aria-describedby="basic-addon1" id="server_url">
                                <span class="input-group-addon">端口号</span>
                                <input type="text" class="form-control"
                                       aria-describedby="basic-addon1" id="server_port">
                                <span class="input-group-addon">用户名</span>
                                <input type="text" class="form-control"
                                       aria-describedby="basic-addon1"
                                       id="server_name">
                                <span class="input-group-addon">密码</span>
                                <input type="text" class="form-control"
                                       aria-describedby="basic-addon1"
                                       id="server_password">
                            </div>
                        </div>
                    </div>
                            <div class="row mt-low">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label>截取日志开始字符</label>
                                        <textarea class="form-control" spellcheck="false" rows="4"
                                               placeholder='如需参数化如从请求中获取值:["request"]["frontTransNo"]'     id="log_begin_split"></textarea>
                                    </div>
                                    </div>
                                  <div class="col-lg-6">
                                      <div class="form-group">
                                           <label>截取日志结束字符</label>
                                        <textarea class="form-control" spellcheck="false" rows="4"
                                           placeholder='如需参数化如从返回中获取值:["result"]["frontTransNo"]'       id="log_over_split"></textarea>
                                    </div>
                                </div>
                            </div>
                    <div class="row mt-low">
                        <div class="col-lg-10">
                        </div>
                        <div class="col-lg-12">
                            <div class="btn-group" role="group" id="log_button_group"
                                 style="position: relative; left: 590px;">
                                <button type="button" class="btn btn-warning" id="log_chongzhi">重置</button>
                                <button type="button" class="btn btn-success" id="log_submit">提交</button>
                            </div>
                        </div>
                    </div>
                </div>
           </div>
                        </div>
                            </div>
                        </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="take_linux_log_kuang">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
    <script src="static/hualala/vendor/jquery/jquery.min.js"></script>
    <script src="static/hualala/vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="static/hualala/vendor/metisMenu/metisMenu.min.js"></script>
    <script src="static/hualala/dist/js/sb-admin-2.js"></script>
    <script src="{{ url_for('static', filename='layer-v3.0/layer/layer.js') }}">
    <script src = "{{url_for('static', filename='jquery-1.8.0.js')}}" ></script>
    <script src="{{ url_for('static', filename='test_file/test10.js') }}"></script>
    <script src="static/jquery-cookie-js/jquery.cookie.js"></script>
    <script type=text/javascript>
        $(document).ready(function () {
            $('#table4').find('tbody').find('tr').each(function () {
                if ($(this).is(':visible')) {
                    $(this).attr('shown', 'true')
                }
                     else
            {
                $(this).removeAttr('shown')
            }
            }
            )
        })
            //监听第一个搜索框内容发生改变
        $("#check_1").bind("DOMNodeInserted", function (e) {
            var name = $(this).html()
            $("#check_2").find('a').html('all')
            $('#table4').find('tr:gt(0)').removeAttr('shown')
            $('#table4').find('tr[name="' + name + '"]').attr('shown','true')
            if (name=='all')
            {
                $('#table4').find('tr:gt(0)').attr('shown','true')
            }
        })
        //监听第二个搜索框内容发生改变
        $("#selecttwo").bind("DOMNodeInserted", function (e) {
            name = $(this).find('a').html()
            $('#table4').find('tr:gt(0)').removeAttr('shown')
            if (name!='all') {
                $('#table4').find('tr[class="' + name + '"]').attr('shown','true')
            }
            else
            {
                name=$("#check_1").html()
                $('#table4').find('tr[name="' + name + '"]').attr('shown','true')
            }
        })

        //case 搜索
        function sousuo_fun() {
            var name = $.trim($('#sousuo_name').val())
            $('#table4').find('tbody').find('tr').each(function () {
                if ($(this).attr('shown') == 'true') {
                    if ($(this).attr('class').indexOf(name) >= 0) {
                        $(this).show()
                    } else {
                        $(this).hide()
                    }
                }
            })
        }

        $('#case_sousuo').click(function () {
            sousuo_fun()

        })


        $(document).keyup(function () {
            if (event.keyCode == 13) {
                sousuo_fun()
            }
        })

    //log设置提交给local，创建或者修改linu_log文件
    var $SCRIPT_ROOT = 'http://'+window.location.host
    $('#log_submit').click(function()
    {
        var huanjing=$('#log_change_huanjing').val()
        var yewu=$('#log_file_yewu').val()
        var gen_mulu=all_mulu = $.cookie('genmulu')
        var log_mulu=$('#log_mulu').val()
        var server_url=$('#server_url').val()
        var server_port=$('#server_port').val()
        var server_name=$('#server_name').val()
        var server_password=$('#server_password').val()
        var log_begin_split=$('#log_begin_split').val()
         var log_over_split=$('#log_over_split').val()
        var post_url='http://127.0.0.1'  + ':'+$('[ name="get_port"]').attr('port') + '/linux_log_reserver'
        $.post(post_url,{huanjing:huanjing,yewu:yewu,gen_mulu:gen_mulu,log_mulu:log_mulu,
       ip:server_url, port:server_port,name:server_name,password:server_password,
       log_begin_split:log_begin_split, log_done_split:log_over_split},function(data)
        {
            if (data.statu=="success")
            {
               $('#take_linux_log_kuang') .modal('hide')
                 layer.msg('更新成功', {
                            shade: [0.3, '#fff'],
                            shadeClose: true,
                            icon: 1,
                            time: 2000 //2秒关闭（如果不配置，默认是3秒）
                        })

            }
            else
            {
                $('#take_linux_log_kuang') .modal('hide')
                 layer.msg(data.error, {
                            shade: [0.3, '#fff'],
                            shadeClose: true,
                            icon: 2,
                            time: 2000 //2秒关闭（如果不配置，默认是3秒）
                        })
            }
        })
    })
    //log 配置模态框点击打开，初始化信息
    $('#take_linux_log_kuang').on('shown.bs.modal', function (e) {
      var huanjing=$('#log_change_huanjing').val()
        var yewu=$('#log_file_yewu').val()
        var gen_mulu=all_mulu = $.cookie('genmulu')
        $.post('http://127.0.0.1'  + ':'+$('[ name="get_port"]').attr('port') + '/read_linux_log',
            {huanjing:huanjing,yewu:yewu,gen_mulu:gen_mulu},function(data){
              if (data.statu!='success'){
                        alert("读取信息失败")
              }
              else
              {
                  $.each( data.linux_log_detail,function(a,b)
                  {
                      if (a=="linux")
                      {
                        $.each(b,function(u,z)
                        {
                            if (u=="ip")
                            {
                                $('#server_url').val(z)
                            }
                            else if(u=="port")
                            {
                                 $('#server_port').val(z)
                            }
                             else if(u=="name")
                            {
                                 $('#server_name').val(z)
                            }
                               else if(u=="password")
                            {
                                 $('#server_password').val(z)
                            }
                        })
                      }
                      elif(a=="split_detail")
                      {
                          $.each(b,function(k,z)
                          {
                                if (k=="log_begin_split")
                           {
                                $('#log_begin_split').val(z)
                           }
                           if (k=="log_done_split")
                           {
                                $('#log_over_split').val(z)
                           }

                          })

                      }
                      elif(a=="mulu")
                      {
                           $.each(b,function(k,z)
                           {
                                $('#log_mulu').val(z)
                           }
                           )
                      }
                  })

              }

            })
})
    //点击读取case的go按钮，存储根目录cookie
    $('#submit_url').click(function () {
         $.cookie("genmulu", "", {expires: -1})
        $.cookie('genmulu', $('#mulu_url').val());

    })
    //获取local  server版本信息
    $(document).ready(function(){
    $('[name="chuancan_type"]').hide()
    $('[name="login_info"]').hide()
var ip = $('input[name="ip_dizhi"]').val()
    $.ajax({
type: "POST",
url: 'http://127.0.0.1'  + ':'+$('[ name="get_port"]').attr('port') + '/banben_data',
data: "",
error: function(data,type, err){
layer.alert('请启动本地server ,若已启动，请从git库更新代码 http://172.16.101.32/TD/Automatic/local_server.git',{icon:2})    },
success: function(msg){
if (msg.statu!=3)
{
alert(msg.statu)
layer.alert('版本过低，请从git库更新代码地址：http://172.16.101.32/TD/Automatic/local_server.git',{icon:2})
}
}
})
    })
//创建接口，环境选择改动，更改业务名
 var local_host = 'http://'+window.location.host
var ip = $('input[name="ip_dizhi"]').val()
$('#create_change_huanjing').change(function(){
    huanjing=$('#create_change_huanjing').val()
    all_mulu = $.cookie('genmulu')
    ip_dizhi = $('#tag_shuruip').attr('name')
    $.post('http://' + ip + ':'+$('[ name="get_port"]').attr('port') + '/get_all_jiekou', {mulu: all_mulu, huanjing: huanjing, ip_dizhi: ip_dizhi},
        function (data) {
            $("#create_file_yewu").empty()
            for (var i=0;i<data.all_yewu.length;i++)
            {
               $("#create_file_yewu").append('<option>'+data.all_yewu[i]+'</option>')
            }

        }
    )
})
        //公共配置文件修改弹出框，根据环境显示业务
    $('#publick_config_select_huanjing').change(function(){
    huanjing=$('#publick_config_select_huanjing').val()
    all_mulu = $.cookie('genmulu')
    ip_dizhi = $('#tag_shuruip').attr('name')
    $.post('http://' + ip + ':'+$('[ name="get_port"]').attr('port') + '/get_all_jiekou', {mulu: all_mulu, huanjing: huanjing, ip_dizhi: ip_dizhi},
        function (data) {
            $("#publick_config_change_yewu_select").empty()
            for (var i=0;i<data.all_yewu.length;i++)
            {

               $("#publick_config_change_yewu_select").append('<option>'+data.all_yewu[i]+'</option>')

            }
        })
            var huanjing=$('div[name="file_secret_publick"]').find('select').val()
             var yewu=$('div[name="file_yewu_publick"]').find('select').val()
             var json_data = $('#json_template_publick').html()
             var gen_mulu=$.cookie('genmulu')

                 $.post('http://' + ip + ':'+$('[ name="get_port"]').attr('port') + '/read_config', {type:"publick_config",gen_mulu:gen_mulu,huanjing:huanjing,yewu:yewu,json_data:json_data},
                        function (data) {
                               $('#json_template_publick').html(data.data)
                        }
             )
})
//  接口级配置文件修改
        $('#jiekou_huanjing_change').change(function(){
    huanjing=$('#publick_config_select_huanjing').val()
    all_mulu = $.cookie('genmulu')
    ip_dizhi = $('#tag_shuruip').attr('name')
    $.post('http://' + ip + ':'+$('[ name="get_port"]').attr('port') + '/get_all_jiekou', {mulu: all_mulu, huanjing: huanjing, ip_dizhi: ip_dizhi},
        function (data) {
            $("#yewu_private_selec_change").empty()
            for (var i=0;i<data.all_yewu.length;i++)
            {
               $("#yewu_private_selec_change").append('<option>'+data.all_yewu[i]+'</option>')
            }
        }
    )
})
    //接口配置文件修改，监控下拉列表业务，如果有发生更改，则更改接口列表
$("#yewu_private_selec_change").change(function(){
        huanjing=$('#publick_config_select_huanjing').val()
    all_mulu = $.cookie('genmulu')
    yewu=$('#yewu_private_selec_change').val()
    ip_dizhi = $('#tag_shuruip').attr('name')
    $.post('http://' + ip + ':'+$('[ name="get_port"]').attr('port') + '/get_yewu_jiekou', {yewu:yewu,mulu: all_mulu, huanjing: huanjing, ip_dizhi: ip_dizhi},
        function (data) {
            $("#private_select_jjiekou_select").empty()
            for (var i=0;i<data.all_jiekou.length;i++)
            {
               $("#private_select_jjiekou_select").append('<option>'+data.all_jiekou[i]+'</option>')
            }
        })
})
//git上传功能，
$('#git_submit_button').click(function()
{
 var mulu=$.trim($('#mulu').next().val())
 var ip = $('input[name="ip_dizhi"]').val()
 if ($.trim(ip)=='')
 {
 ip=window.location.host.split(':')[0]
 }
 var git_address=$.trim($('#git_address').next().val())
 if  (mulu=='' ||  git_address=='' )
 {
 $('#git_submit_alert').html('参数均不能为空')
    $('#git_submit_alert').show()

 }
 else
 {
 var index = layer.load(1, {
  shade: [0.1,'#fff'] //0.1透明度的白色背景
});
$('#git_submit').modal('hide')
     $.post('http://' + '127.0.0.1' + ':'+$('[ name="get_port"]').attr('port') + '/set_local_file_save', {mulu:mulu, git_address: git_address,ip:ip},
        function (data) {
        layer.close(index)
        if (data.statu=='success')
        {
         layer.msg('上传成功',{icon: 1});

        }
                else if  (data.statu=='no file')
        {
        layer.msg('目录地址不存在',{icon: 2});
        }
        else
        {
        alert(data.detail);
        }


        $.post('http://' + '127.0.0.1' + ':'+$('[ name="get_port"]').attr('port') + '/delete_local_file_save',{file_path:data.file_path},function()
        {

        })

        })
        }
}
)

$('#git_submit').on('hidden.bs.modal', function () {
  $('#git_submit_alert').hide()
})

//log 页面输入重置
    $('#log_chongzhi').click(function () {
        $('#log_mulu').val('')
        $('#server_url').val('')
        $('#server_port').val('')
        $('#get_log_name').val('')
        $('#server_port').val('')
        $('#server_name').val('')
        $('#server_password').val('')
        $('#log_begin_split').val('')
        $('#log_over_split').val('')
    })

    //log  模态框点击关闭
    $('[data-dismiss="take_linux_log_kuang"]').click(function () {
            $('#take_linux_log_kuang').modal('hide')
        }
    )
    //log 模态框 选择环境，发送请求
    $('#log_change_huanjing').change(function () {
        var huanjing = $(this).val()
        var first_yewu = ''
        var gen_mulu = $.cookie('genmulu')
        $.post('http://127.0.0.1:' + $('[ name="get_port"]').attr('port') + '/get_all_jiekou', {
                huanjing: huanjing,
                mulu: gen_mulu,
                ip_dizhi: $('input[name="ip_dizhi"]').val()
            },
            function (data) {
                if (data.statu == 'success') {
                    $('#log_file_yewu').empty()
                    var append_htmle = ''
                    first_yewu = data.all_yewu[0]
                    for (var i = 0; i < data.all_yewu.length; i++) {
                        append_htmle = append_htmle + '<option>' + data.all_yewu[i] + '</option>'
                    }
                    $('#log_file_yewu').append(append_htmle)
                }


                $.post('http://127.0.0.1' + ':' + $('[ name="get_port"]').attr('port') + '/raad_log_file', {
                        huanjing: huanjing,
                        mulu: gen_mulu,
                        yewu: first_yewu
                    },
                    function (data) {
                        alert(data.statu)
                        if (data.statu == 'read_success') {
                            var detail = $.parseJSON(data.detail)
                            $('#get_log_name').val(detail.name)
                            $('#log_mulu').val(detail.mulu)
                            $('#server_url').val(detail.ip)
                            $('#server_port').val(detail.port)
                            $('#server_name').val(detail.user)
                            $('#server_password').val(detail.password)
                            $('#log_begin_split').val(detail.begin_str)
                            $('#log_over_split').val(detail.finish_str)
                        }
                    })
            })
    })

//根据页面选择后台加密，登录框显示与否
$('[name="sign_type"]').find('select').change(function(){
if ($(this).val()=='Backstage_web')
{
$('[name="login_info"]').hide()

}
if ($(this).val()!='Backstage_web')
{
$('[name="login_info"]').hide()

}
})
//设置传参方式
$('[name="file_method"]').change(function(){
if ($(this).find('select').val()=='post')
{
$('[name="chuancan_type"]').show()
}
else
{
$('[name="chuancan_type"]').hide()
}

})



    $('#create_file_save_last').click(function() {
     //环境名称
     if ($('#basic-url').is(':visible')) {
         var ip = $('input[name="ip_dizhi"]').val()
         var huanajing = $('div[name="file_secret"]').find('select').val()
         var yewu = $('div[name="file_yewu"]').find('select').val()
         var sign_type = $('div[name="sign_type"]').find('select').val()
         var method = $('div[name="file_method"]').find('select').val()
         var request_url = $('#basic-url').val()
         var json_data = $('#json_template').text()
         $('#publick_db').modal('hide')
         if ($('#file_jiekou_name').val().indexOf(" ")>=0)
         {
            alert("接口名不能包含空格")
         }
     else
         {

                      $.post('http://' + ip + ':'+$('[ name="get_port"]').attr('port') + '/creat_file', {
                 gen_mulu: $.cookie('genmulu'),
                              yewu: yewu,
                              huanjing: huanajing,
                              sign_type: sign_type,
                              request_type: $('[name="send_request"]').find('select').val(),
                              method: method,
                              request_url: request_url,
                              json_data: json_data,
                              jiekou_name: $('#file_jiekou_name').val()
                          },
                          function (data) {
                              if (data.statu == "success") {
                                  layer.msg('创建成功', {icon: '1'})

                              } else {
                                  layer.msg(data.statu, {icon: '0'})
                              }
                          }
                      )

         }
     }


        //保存db配置文件
        if ($('#json_template_db').is(':visible')) {
            var ip = $('input[name="ip_dizhi"]').val()
            var huanjing = $('div[name="file_secret_db"]').find('select').val()
            var yewu = $('div[name="file_yewu_db"]').find('select').val()
            var json_data = $('#json_template_db').html()
            var gen_mulu = $.cookie('genmulu')
            var json_data = $('#json_template_db').html()
            $('#publick_db').modal('hide')
            $.post('http://' + ip + ':' + $('[ name="get_port"]').attr('port') + '/save_conifg', {
                    type: "db_config",
                    gen_mulu: gen_mulu,
                    yewu: yewu,
                    huanjing: huanjing,
                    json_data: json_data,
                },
                function (data) {
                    if (data.statu == "success") {
                        layer.msg('更新成功', {icon: '1'})

                    } else {
                        layer.msg(data.statu, {icon: '0'})
                    }
                }
            )
        }


        //保存publick配置文件
        if ($('#json_template_publick').is(':visible')) {
            var ip = $('input[name="ip_dizhi"]').val()
            var huanjing = $('div[name="file_secret_publick"]').find('select').val()
            var yewu = $('div[name="file_yewu_publick"]').find('select').val()
            var json_data = $('#json_template_publick').html()
            var gen_mulu = $.cookie('genmulu')

            $('#publick_db').modal('hide')
            $.post('http://' + ip + ':' + $('[ name="get_port"]').attr('port') + '/save_conifg', {
                    type: "publick_config",
                    gen_mulu: gen_mulu,
                    yewu: yewu,
                    huanjing: huanjing,
                    json_data: json_data,
                },
                function (data) {
                    if (data.statu == "success") {
                        layer.msg('更新成功', {icon: '1'})

                    } else {
                        layer.msg(data.statu, {icon: '0'})
                    }
                }
            )
        }

        //保存接口配置配置文件
        if ($('select[name="file_yewu_private_select"]').is(':visible')) {
            var ip = $('input[name="ip_dizhi"]').val()
            var huanjing = $('div[name="s"]').find('select').val()
            var yewu = $('div[name="file_yewu_private"]').find('select').val()
            var jiekou = $('#private_select_jjiekou_select').val()
            var config_data = $('#json_template_private').html()
            var gen_mulu = $.cookie('genmulu')
            var json_text = $('#json_moban_private').text()
            $('#publick_db').modal('hide')
            $.post('http://' + ip + ':' + $('[ name="get_port"]').attr('port') + '/save_conifg', {
                    type: "private_config",
                    gen_mulu: gen_mulu,
                    huanjing: huanjing,
                    yewu: yewu,
                    config_data: json_data,
                    json_data: json_text,
                    jiekou: jiekou

                },
                function (data) {
                    if (data.statu == "success") {
                        layer.msg('更新成功', {icon: '1'})

                    } else {
                        layer.msg(data.statu, {icon: '0'})
                    }

                }
            )
        }


    })
    </script>
{% endblock %}